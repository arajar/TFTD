#include "core.h"
#include "StateManager.h"

//////////////////////////////////////////////////////////////////////////

StateManager::StateManager()
{
}

//////////////////////////////////////////////////////////////////////////

void StateManager::Update(sf::Time deltaTime)
{
	m_states.back()->Update(deltaTime);
}

//////////////////////////////////////////////////////////////////////////

void StateManager::Render(sf::RenderTarget& target)
{
	m_states.back()->Render(target);
}

//////////////////////////////////////////////////////////////////////////

void StateManager::RenderDebug(sf::RenderTarget& target)
{
	m_states.back()->RenderDebug(target);
}

//////////////////////////////////////////////////////////////////////////

void StateManager::HandleEvents(core::WindowEvent event)
{
	m_states.back()->HandleEvents(event);
}

//////////////////////////////////////////////////////////////////////////

State* StateManager::GetCurrentState()
{
	return m_states.back();
}

//////////////////////////////////////////////////////////////////////////

bool StateManager::PopState()
{
	if (!m_states.empty())
	{
		auto lastState = m_states.back();
		lastState->Suspend();
		lastState->End();
		m_states.pop_back();
	}

	return m_states.empty();
}

//////////////////////////////////////////////////////////////////////////

void StateManager::PopAllStates()
{
	if (!m_states.empty())
	{
		auto lastState = m_states.back();
		lastState->Suspend();
	}

	while (!m_states.empty())
	{
		auto lastState = m_states.back();
		lastState->End();
		m_states.pop_back();
	}
}

//////////////////////////////////////////////////////////////////////////